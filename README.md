The inference engine code refer from https://github.com/dreaming-panda/FlexSpec
